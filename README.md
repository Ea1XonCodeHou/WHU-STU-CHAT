# WHU-STU-CHAT
C#大作业团队仓库——武汉大学学生互助交流平台
<<<<<<< HEAD

## 版本信息
- **当前版本**: V-0.0.2T (测试版)
- **更新时间**: 2025-4-26
- **更新人**: Noteles

## 更新内容
1. 完成了个群聊（私聊）的后端文件

## 有待完善
1. 前端的配套实现
2. hub的测试

## 技术栈
- **前端**: Vue.js + SignalR客户端
- **后端**: ASP.NET Core + SignalR
- **数据库**: MySQL

## 使用说明
1. 用户需先注册账号并登录
2. 登录后可进入公共聊天室与其他用户交流
3. 在聊天室可发送消息、查看在线用户
=======
# 校园内部聊天平台功能说明

## 1. 聊天功能

### a) 私聊（个人聊天）
- **功能**：用户可以与其他用户进行一对一的私密交流，支持发送文字、图片、文件等。
- **消息状态**：支持“未读”和“已读”状态，用户可随时查看消息是否已阅读。
- **通知功能**：收到新私信时，系统会及时通知，确保用户不会错过任何重要信息。

### b) 群聊（群组聊天）
- **功能**：用户可以创建群聊，设定群聊名称、头像、描述，并邀请其他用户加入。
- **群成员管理**：群主可以管理群成员，设置管理员权限、移除成员等。
- **消息推送**：群聊消息实时同步，群成员可以随时查看并响应消息。
- **文件共享**：群聊支持图片、文件等多种形式的附件发送，方便分享学习资料。
- **群消息搜索**：支持根据时间、关键词等快速检索群聊中的历史消息。

### c) 公域聊天（开放聊天室）
- **功能**：开放多个聊天室，供用户参与不同主题的公共讨论。
- **聊天室**：如“校园公告区”、“活动讨论区”等，用户可以自由进入参与话题讨论。
- **实时消息**：支持文字、图片、文件的实时消息传递，增强互动性。
- **话题标签**：每条消息可以加上话题标签，方便后续分类和检索。

---

## 2. 社区讨论（类似贴吧）功能

### a) 课程讨论区
- **功能**：每门课程都有一个独立的讨论区，用户可以在课程区内讨论相关课程内容、分享学习资料、提问问题等。
- **帖子管理**：课程讨论区支持用户发布帖子，支持对帖子进行评论、点赞和回复。
- **评论系统**：支持树状评论结构，评论可以有多层级的回复，形成有序的讨论链。
- **课程评分与评价**：用户可以为课程打分，并附加评论，系统自动计算课程的平均评分，并显示在课程详情页面。

### b) 课程评分系统
- **评分范围**：用户可以对每门课程进行评分，评分从 1 到 5 分。
- **评分展示**：课程页面将展示课程的 **平均评分**，并提供 **评分分布**（例如：多少人给了 1 星，多少人给了 5 星等）。
- **评论展示**：评分后，用户可以撰写详细评论，评论按时间倒序展示，支持用户回复其他评论，形成树状结构。

### c) 其他讨论区（食堂区、图书馆区等）
- **功能**：除了课程讨论区，平台还支持多个主题讨论区，如“食堂区”、“图书馆区”等，用户可以针对不同的兴趣或话题发布帖子。
- **讨论区管理**：每个讨论区有专门的管理员，可以删除违规内容，禁止恶意用户发言。





1. 用户表

| 字段名          | 数据类型         | 说明            |
| ------------ | ------------ | ------------- |
| UserId       | INT          | 主键，用户唯一标识     |
| Username     | VARCHAR(50)  | 用户名           |
| PasswordHash | VARCHAR(255) | 密码的哈希值        |
| Email        | VARCHAR(100) | 邮箱            |
| ProfilePic   | VARCHAR(255) | 头像 URL        |
| Role         | VARCHAR(20)  | 用户角色（如用户、管理员） |
| CreatedAt    | DATETIME     | 用户注册时间        |
| LastLogin    | DATETIME     | 最后登录时间        |

2. 聊天表（私聊、群聊和公域聊天）

| 字段名         | 数据类型         | 说明                                 |
| ----------- | ------------ | ---------------------------------- |
| ChatId      | INT          | 主键，聊天唯一标识                          |
| ChatName    | VARCHAR(100) | 聊天名称（用于群聊）                         |
| ChatType    | VARCHAR(20)  | 聊天类型（如 "private"、"group"、"public"） |
| CreatedBy   | INT          | 外键，创建者的 UserId                     |
| CreatedAt   | DATETIME     | 创建时间                               |
| Description | TEXT         | 群聊描述（群聊时使用）                        |

3. 消息表

| 字段名         | 数据类型        | 说明                            |
| ----------- | ----------- | ----------------------------- |
| MessageId   | INT         | 主键，消息唯一标识                     |
| ChatId      | INT         | 外键，关联到聊天表                     |
| SenderId    | INT         | 外键，发送者的 UserId                |
| Message     | TEXT        | 消息内容                          |
| MessageType | VARCHAR(20) | 消息类型（如 "text"、"image"、"file"） |
| SentAt      | DATETIME    | 发送时间                          |


4. 用户群聊关联表

记录每个用户与不同聊天的关联，用于群聊和私聊的成员管理

| 字段名      | 数据类型     | 说明             |
| -------- | -------- | -------------- |
| UserId   | INT      | 外键，用户的 UserId  |
| ChatId   | INT      | 外键，聊天的 ChatId  |
| JoinDate | DATETIME | 加入聊天的时间        |
| IsAdmin  | BOOLEAN  | 是否是管理员（仅对群聊有效） |
5. 帖子表（用于存储用户在不同讨论区发布的帖子：相关课程）

| 字段名       | 数据类型         | 说明                |
| --------- | ------------ | ----------------- |
| PostId    | INT          | 主键，帖子唯一标识         |
| UserId    | INT          | 外键，发帖人的 UserId    |
| Title     | VARCHAR(100) | 帖子标题              |
| Content   | TEXT         | 帖子内容              |
| CreatedAt | DATETIME     | 帖子创建时间            |
| UpdatedAt | DATETIME     | 帖子更新时间（如果编辑过的话）   |
| Category  | VARCHAR(50)  | 讨论区类别（如课程讨论、食堂区等） |
|           |              | 细分类别（课程、食堂）       |
|           |              |                   |

6. 评论表

| 字段名       | 数据类型     | 说明                       |
| --------- | -------- | ------------------------ |
| CommentId | INT      | 主键，评论唯一标识                |
| PostId    | INT      | 外键，关联到帖子表                |
| UserId    | INT      | 外键，评论者的 UserId           |
| Comment   | TEXT     | 评论内容                     |
| ParentId  | INT      | 外键，父评论的 CommentId（如果是回复） |
| CreatedAt | DATETIME | 评论创建时间                   |

7. 评分表

| 字段名       | 数据类型     | 说明                |
| --------- | -------- | ----------------- |
| RatingId  | INT      | 主键，评分唯一标识         |
| CourseId  | INT      | 外键，关联到课程表（假设有课程表） |
| UserId    | INT      | 外键，评分人的 UserId    |
| Rating    | INT      | 评分（1 到 5 分）       |
| Comment   | TEXT     | 评分的附加评论           |
| CreatedAt | DATETIME | 评分时间              |

8. 文件表

| 字段名        | 数据类型         | 说明                       |
| ---------- | ------------ | ------------------------ |
| FileId     | INT          | 主键，文件唯一标识                |
| FileName   | VARCHAR(255) | 文件名                      |
| FilePath   | VARCHAR(255) | 文件存储路径                   |
| FileType   | VARCHAR(50)  | 文件类型（如 "image", "pdf" 等） |
| Size       | INT          | 文件大小（字节数）                |
| UploadedBy | INT          | 外键，上传者的 UserId           |
| UploadedAt | DATETIME     | 上传时间                     |
| ChatId     | INT          | 外键，关联到聊天表                |

9. 通知表（记录用户接收到的系统通知，如新消息提醒等）

|字段名|数据类型|说明|
|---|---|---|
|NotificationId|INT|主键，通知唯一标识|
|UserId|INT|外键，接收通知的 UserId|
|Content|TEXT|通知内容|
|IsRead|BOOLEAN|是否已读|
|CreatedAt|DATETIME|通知创建时间|
>>>>>>> 3b8a73c91bbd608f896950261f2e7a6c9b32a440
