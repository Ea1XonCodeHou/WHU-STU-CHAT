# WHU-STU-CHAT
C#大作业团队仓库——武汉大学学生互助交流平台

## 项目简介
WHU-STU-CHAT是一个专为武汉大学学生设计的互助交流平台，提供即时通讯、AI助手、社区讨论等功能，旨在促进校园内部的沟通与信息共享。

## 版本信息
- **当前版本**: V-0.1.2 (测试版)
- **最新更新时间**: 2025-5-19
- **更新人**: Noteles

## 已实现功能

### 聊天系统
- **公共聊天室**: 提供5个预设的公共聊天区域，支持文本和表情
- **私聊功能**: 支持用户间一对一聊天，显示在线状态，发送文件和Emoji
- **群聊功能**: 创建、加入和管理群聊，支持群成员管理
- **AI智能助手**: 集成AI模型，提供问答服务，支持多轮对话，保存聊天历史

### 用户系统
- **用户注册登录**: 完整的注册、登录功能，支持会话保持
- **好友系统**: 添加好友、好友请求管理、好友列表显示
- **在线状态管理**: 显示用户在线/离线状态，支持隐藏在线状态
- **通知系统**: 好友请求、系统通知等消息提醒

### 社区功能
- **话题讨论区**: 支持多个讨论主题，发布和回复帖子
- **匿名发帖**: 支持匿名发表帖子和评论
- **点赞功能**: 支持对帖子点赞

### 用户设置
- **个人资料管理**: 修改头像、签名等个人信息
- **通知设置**: 消息免打扰、在线状态显示等设置

### 群组聊天
- **群组的管理**: 管理员权限下的创建、添加与删除
- **群组聊天**： 在同一群组下实时发送信息，表情，图片功能



## 待开发功能
1. 文件传输功能改进
2. 更多社区互动功能
3. 移动端适配优化

## 安装指南

### 前端部署
```bash
# 进入前端目录
cd frontend/whu-chat-frontend

# 安装依赖
npm install

# 运行开发服务器
npm run serve

# 构建生产环境版本
npm run build
```

### 后端部署
```bash
# 进入后端目录
cd backend

# 还原NuGet包
dotnet restore

# 构建项目
dotnet build

# 运行项目
dotnet run
```

### 数据库部署
1. 在MySQL中创建名为`whu-chat`的数据库
2. 执行`sql-data/whu-chat-v1.sql`脚本创建表结构和初始数据
3. 在`backend/appsettings.json`中配置数据库连接字符串

## 使用指南

### 登录和注册
- 打开应用后，输入用户名和密码登录
- 首次使用请点击注册按钮创建账号
- 测试账号: username: "Mike", password: "123456"

### 聊天功能
- 主页面可以查看和进入公共聊天室
- 点击好友列表中的用户可以发起私聊
- 创建或加入群组可以参与群聊
- 点击AI助手图标启动智能对话

### 社区互动
- 在"讨论区"标签页浏览不同主题的讨论
- 点击发帖按钮创建新的帖子
- 可以对帖子进行评论和点赞操作

### 个人设置
- 点击右上角头像进入个人设置
- 可以管理个人资料、通知设置和隐私选项

## 技术栈
- **前端**: Vue.js 3 + Vite + SignalR客户端
- **后端**: ASP.NET Core 7 + SignalR + DeepSeek AI API
- **数据库**: MySQL 8.0
- **通信**: WebSocket + RESTful API

## 贡献者
- Eaxon: 项目架构、后端开发
- Mike: 前端开发
- Shiro: 数据库设计
- Tom: AI功能实现

## 故障排除

### 常见问题
1. 数据库连接失败: 检查MySQL服务是否运行，连接字符串是否正确
2. 前端构建错误: 确保Node.js版本>= 14.0，重新安装依赖
3. 聊天功能不可用: 检查SignalR连接状态，可能是跨域问题

### 联系支持
如遇问题请提交Issue或联系开发团队: whu-chat-team@example.com

## todo
1. 私聊功能V2
2. 好友界面设计
3. 个人信息修改
4. 群组高级功能


## 更新内容（5-16）

1. 重构群组/私聊核心逻辑
   - 优化了消息发送和接收的实时性
   - 修复了群组消息重复发送的问题
   - 改进了私聊消息的存储和检索机制
   - 实现了消息发送失败的重试机制
   - 优化了消息加载性能，采用分页加载

2. 数据库优化与调试
   - 重构了用户关系表结构，提高查询效率
   - 优化了消息表的索引设计
   - 添加了消息状态追踪字段
   - 实现了数据库连接池管理
   - 添加了数据库操作日志记录

3. 接入阿里云OSS服务
   - 实现了个人头像上传功能
     * 支持图片压缩和格式转换
     * 添加了图片大小限制
     * 实现了图片预览功能
   - 实现了文件上传功能
     * 支持多种文件格式
     * 添加了文件大小限制
     * 实现了上传进度显示
     * 添加了文件类型验证

4. 会员系统框架搭建
   - 设计了会员等级体系
   - 实现了会员权限控制
   - 添加了会员专属功能入口
   - 预留了支付接口
   - 设计了会员状态管理机制

技术要点：
- 使用SignalR实现了实时消息推送
- 采用阿里云OSS SDK进行文件存储
- 使用Redis缓存优化数据访问
- 实现了基于JWT的身份认证
- 采用EF Core进行数据库操作

修改人：侯宜辰


## 更新内容（5-15）

1. 修复了私聊离线状态判断问题
   - 每次加入或离开私聊会广播状态
   - 查询对方用户在线状态
   - 修复了主页上好友在线状态显示的问题

2. 实现私聊文件发送
   - 直接通过绑定消息类型的方式发送文件
   - 可以下载到本地，实现了文件传输

3. 实现私聊emoji发送
   - 增加了一系列emoji列表
   - 丰富聊天内容和趣味性

## 更新内容（5-11）
1. 修复了用户在线/离线状态判断问题
   - 聊天室中的在线用户现在正确反映实际在聊天室内的用户
   - 用户退出聊天室后会立即从在线用户列表中移除
   - 修复了主页上好友在线状态显示的问题

2. 实现了好友系统功能重构与完善
   - 集成数据库Friendships表进行好友关系管理
   - 在聊天室的在线用户界面添加了用户名片显示
   - 新增了向聊天室用户发送好友请求功能(带验证消息)
   - 为用户名片添加了多种状态显示(已是好友/请求待处理/被拒绝等)
   - 优化了好友请求通知的显示与处理流程

3. 优化了系统架构
   - 添加了FriendshipService服务管理好友关系
   - 完善了通知管理系统与用户状态同步机制

## 更新内容（5-7）
1. 完成了群组搜索功能
2. 修改了几个小bug
3. 初步完成了好友功能
4. 完善了群组聊天的页面

## 更新内容（4-28）
1. 完成并测试了群聊的后端与后端
2. 聊天成员表删除了1列
3. 融入框架了

## 更新内容（4-28）
1.实现AI对话咨询板块
2.实现AI接入聊天室进行总结
3.聊天室支持多媒体聊天（包含表情包/图片）
4.实现主页基础架构

## 技术栈
- **前端**: Vue.js + SignalR客户端
- **后端**: ASP.NET Core + SignalR+OpenAI
- **数据库**: MySQL+Redis

## 使用说明
1. 用户需先注册账号并登录
2. 登录后可进入公共聊天室与其他用户交流
3. 在聊天室可发送消息、查看在线用户
# 校园内部聊天平台功能说明

## 1. 聊天功能

### a) 私聊（个人聊天）
- **功能**：用户可以与其他用户进行一对一的私密交流，支持发送文字、图片、文件等。
- **消息状态**：支持"未读"和"已读"状态，用户可随时查看消息是否已阅读。
- **通知功能**：收到新私信时，系统会及时通知，确保用户不会错过任何重要信息。

### b) 群聊（群组聊天）
- **功能**：用户可以创建群聊，设定群聊名称、头像、描述，并邀请其他用户加入。
- **群成员管理**：群主可以管理群成员，设置管理员权限、移除成员等。
- **消息推送**：群聊消息实时同步，群成员可以随时查看并响应消息。
- **文件共享**：群聊支持图片、文件等多种形式的附件发送，方便分享学习资料。
- **群消息搜索**：支持根据时间、关键词等快速检索群聊中的历史消息。

### c) 公域聊天（开放聊天室）
- **功能**：开放多个聊天室，供用户参与不同主题的公共讨论。
- **聊天室**：如"校园公告区"、"活动讨论区"等，用户可以自由进入参与话题讨论。
- **实时消息**：支持文字、图片、文件的实时消息传递，增强互动性。
- **话题标签**：每条消息可以加上话题标签，方便后续分类和检索。

---